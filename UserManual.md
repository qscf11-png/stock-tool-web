# 台股投資健康度檢視工具 使用說明書

## 1. 產品簡介

「台股投資健康度檢視工具」是一款專為台股投資者設計的個人化分析工具。本系統結合現代化的儀表板介面與即時資料串接技術，協助您輕鬆管理投資組合、追蹤績效表現，並透過 AI 輔助分析與風險預警功能，全方位掌握您的投資健康度。

### 主要特色

- **即時儀表板**：一目瞭然的總資產市值、投入成本、未實現損益與投資報酬率 (ROI)。
- **自動化股價更新**：整合 Yahoo Finance API，自動抓取台股（上市/上櫃）最新報價。
- **完整交易記錄**：支援買入、賣出交易紀錄，自動計算持股成本與損益。
- **AI 智能顧問**：內建 AI 分析模組，提供投資組合成效評估與建議。
- **風險管理**：產業分佈分析與情境式警示，協助您分散風險。
- **資料備份與匯出**：支援 Excel 匯入/匯出與 JSON 完整備份，資料安全有保障。

---

## 2. 系統需求與安裝

在使用本工具之前，請確保您的電腦已安裝以下環境：

### 系統需求

- **作業系統**：Windows 10/11
- **執行環境**：Node.js (建議版本 v18 以上)
- **瀏覽器**：Google Chrome (建議)、Microsoft Edge 或其他現代化瀏覽器

### 安裝步驟

1. **下載專案**
    將本工具的資料夾下載或複製到您的電腦中（例如：`C:\Users\YourName\StockTool`）。

2. **安裝依賴套件**
    開啟命令提示字元 (CMD) 或 PowerShell，進入專案資料夾，並執行以下指令以安裝所需套件：

    ```bash
    cd 您的專案路徑
    npm install
    ```

    *注意：若您已完成初始設定，可跳過此步驟。*

---

## 3. 快速啟動

本工具提供一鍵啟動腳本，讓您無需記憶繁雜指令即可開始使用。

### 啟動方式

1. 進入工具資料夾。
2. 雙擊執行 **`啟動股票工具.bat`** 檔案。
3. 系統將自動執行以下動作：
    - 啟動後端 API 伺服器 (Port 3001)。
    - 啟動前端網頁伺服器。
    - 自動開啟 Google Chrome 並進入工具頁面 (`http://localhost:5173`)。

### 關閉方式

* 直接關閉開啟的 Chrome 視窗。
- 關閉啟動時跳出的黑色命令提示字元視窗 (CMD)，系統將自動停止所有背景服務。

---

## 4. 功能操作指南

### 4.1 儀表板 (Dashboard)

進入系統後，首頁即為投資組合總覽儀表板。
- **頂部資訊列**：顯示目前日期、時間，以及股市狀態（🟢 開盤中 / ⚫ 休市）。
- **核心指標**：
  - **總投入成本**：您目前持有的所有股票之原始買入總成本。
  - **總資產市值**：依據最新股價計算的持股總價值。
  - **未實現損益**：帳面上的預估獲利或虧損金額。
  - **總報酬率**：整體的投資回報百分比。
- **資料來源指示燈**：
  - 🟢 **綠燈**：連線正常，使用 Yahoo Finance 或 TWSE 即時數據。
  - 🟡 **黃燈**：使用模擬數據或快取資料。
  - ⚪ **灰燈**：尚無資料。

### 4.2 持股管理 (Holdings)

* **新增交易**：
    1. 點擊右上角的 **「＋ 新增交易」** 按鈕。
    2. 選擇交易類型：**買入** (紅色) 或 **賣出** (綠色)。
    3. 輸入 **股票代號** (如 2330)、**交易股數**、**成交價格** 與 **交易日期**。
    4. 點擊「確認交易」即可。
- **查看持股**：
  - 列表顯示每檔持股的 現價、持有股數、平均成本、市值 與 個股損益。
  - 系統會自動合併同一檔股票的多筆交易，計算平均成本。

### 4.3 績效與分析

* **績效追蹤**：點擊上方 **「績效追蹤」** 分頁，查看資產變化的歷史趨勢圖表。
- **產業分佈**：儀表板下方提供圓餅圖，分析您的資金在電子、金融、傳產等各產業的配置比例。
- **已實現損益**：顯示您過去賣出股票所獲得的實際獲利或虧損。
- **AI 顧問建議**：根據您的持股風險與績效，AI 會提供簡短的投資組合調整建議。

### 4.4 資料備份與還原

為了避免資料遺失，建議您定期備份。
- **Excel 匯出**：點擊 **「Excel 匯出」**，將交易紀錄匯出為 `.xlsx` 檔，方便在 Excel 中查看或進行二次利用。
- **Excel 匯入**：點擊 **「Excel 匯入」**，可將外部整理好的交易紀錄匯入系統（注意：這將覆蓋或更新現有資料）。
- **JSON 備份 (資料全備份)**：
  - 點擊 **「備份」** (Download Icon)，將完整系統資料存為 `.json` 檔。
  - 點擊 **「復原」** (Upload Icon)，選取之前的備份檔以還原所有資料。

---

## 5. 常見問題 (FAQ)

**Q1: 為什麼股價顯示「查無資料」或沒有更新？**
A1:

1. 請確認您的網路連線正常。
2. 請確認後端伺服器視窗（黑色 CMD 視窗）是否正如常執行中，沒有被關閉。
3. 盤中股價可能有延遲（約 15 分鐘），此為 Yahoo Finance 免費 API 之限制。
4. 若遇到 API 連線限制，請稍待片刻後再點擊「更新價格」按鈕。

**Q2: 如何新增「現金股利」紀錄？**
A2: 目前版本專注於價差損益計算，尚未內建股利紀錄功能。建議您可在賣出價格中自行調整（例如將股利加回賣出價），或等待未來版本更新。

**Q3: 支援美股嗎？**
A3: 目前主要針對 **台股 (TWSE/TPEX)** 設計。雖可輸入美股代號，但報價來源與幣值計算可能會有誤差，建議僅用於台股。

**Q4: 資料儲存在哪裡？會上傳雲端嗎？**
A4: 所有交易資料僅儲存在您電腦的瀏覽器 **Local Storage** 中，**完全不會** 上傳至任何外部雲端伺服器，請安心使用。但這也代表若您清空瀏覽器快取，資料將會消失，因此**強烈建議定期匯出 JSON 備份檔**。

---

**版本資訊**
- 版本：v1.0.0
- 最後更新：2026/02/12
